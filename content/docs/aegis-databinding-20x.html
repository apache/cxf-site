
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Aegis Databinding (2.0.x)">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushBash.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>
Apache CXF -- Aegis Databinding (2.0.x)
    </title>
  </head>
<body onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <td id="cell-0-0" colspan="2">&nbsp;</td>
    <td id="cell-0-1">&nbsp;</td>
    <td id="cell-0-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-1-0">&nbsp;</td>
    <td id="cell-1-1">&nbsp;</td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight: bold; font-size: 170%; color: white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="The Apache Sofware Foundation"><img border="0" alt="ASF Logo" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs -->
<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="databindings.html">DataBindings</a>&nbsp;&gt;&nbsp;<a href="aegis-databinding-20x.html">Aegis Databinding (2.0.x)</a>
                <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">Download</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">Documentation</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </table>
      </div>
    </td>
    <td id="cell-1-3">&nbsp;</td>
    <td id="cell-1-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2">&nbsp;</td>
    <td id="cell-2-1">
      <table>
        <tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">Overview</a></li><li><a shape="rect" href="how-tos.html">How-Tos</a></li><li><a shape="rect" href="frontends.html">Frontends</a></li><li><a shape="rect" href="databindings.html">DataBindings</a></li><li><a shape="rect" href="transports.html">Transports</a></li><li><a shape="rect" href="configuration.html">Configuration</a></li><li><a shape="rect" href="debugging-and-logging.html">Debugging and Logging</a></li><li><a shape="rect" href="tools.html">Tools</a></li><li><a shape="rect" href="restful-services.html">RESTful Services</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL Bindings</a></li><li><a shape="rect" href="service-routing.html">Service Routing</a></li><li><a shape="rect" href="dynamic-languages.html">Dynamic Languages</a></li><li><a shape="rect" href="ws-support.html">WS-* Support</a></li><li><a shape="rect" href="advanced-integration.html">Advanced Integration</a></li><li><a shape="rect" href="deployment.html">Deployment</a></li><li><a shape="rect" href="schemas-and-namespaces.html">Use of Schemas and Namespaces</a></li></ul><hr><ul class="alternate"><li><p>Search</p></li></ul><form enctype="application/x-www-form-urlencoded" method="get" id="cse-search-box" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="Search">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF Website</a></li></ul><p>&#160;</p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><p>For CXF up to 2.0.x</p>
<h1 id="AegisDatabinding(2.0.x)-WhyAegis?">Why Aegis?</h1>
<p>Aegis is a fast, StAX based, data-binding that makes developing code first services as simply as possible. It is able to handle most classes and create intelligent schemas for them. </p>

<p>Features include:</p>
<ul class="alternate"><li>No annotations are needed to expose classes</li><li>Support for interfaces</li><li>Support for collections including Maps</li><li>Support for a wide variety of datatypes</li></ul>


<h1 id="AegisDatabinding(2.0.x)-CXF2.1Documentation">CXF 2.1 Documentation</h1>

<p>There are some significant changes to Aegis in CXF 2.1. See <a shape="rect" href="aegis-21.html">Aegis (2.1)</a>.</p>

<h1 id="AegisDatabinding(2.0.x)-DetailsonHowItWorks">Details on How It Works</h1>

<p><a shape="rect" href="aegis-theory-of-operation-20x.html">This Page</a>, which is a work in progress, explains some of the modularity of Aegis. You may find it helpful in understanding Aegis' behavior and in developing customizations.</p>

<h1 id="AegisDatabinding(2.0.x)-UsingAegis">Using Aegis</h1>
<p>Most people who use Aegis use the <a shape="rect" href="simple-frontend.html">Simple Front End</a>. If you are using Aegis, you can't move your code to some other web service framework without modifying all your code to work with JAXB or some other binding, so there's not much advantage to using the JAX-WS front-end. You might want to use Aegis with one of the specialized frontends, like JAX-RS. We don't have examples of that in this documentation.</p>

<h2 id="AegisDatabinding(2.0.x)-SpringConfiguration">Spring Configuration</h2>

<p>Most people who use Aegis use the 'Simple' front end. </p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;simple:server id="pojoservice" serviceClass="demo.hw.server.HelloWorld" address="/hello_world"&gt;
  &lt;simple:serviceBean&gt;
    &lt;bean class="demo.hw.server.HelloWorldImpl" /&gt;
  &lt;/simple:serviceBean&gt;
  &lt;simple:dataBinding&gt;
    &lt;bean class="org.apache.cxf.aegis.databinding.AegisDatabinding" /&gt;
  &lt;/simple:dataBinding&gt;
  &lt;!-- Use this property only for XFire compatibility -- this version for 2.0.x ...
  &lt;property name="serviceConfigurations"&gt;
    &lt;list&gt;
      &lt;bean class="org.apache.cxf.jaxws.support.JaxWsServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.aegis.databinding.AegisServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.service.factory.DefaultServiceConfiguration"/&gt; 
    &lt;/list&gt;
  &lt;/property&gt;
  --&gt;
&lt;/simple:server&gt;
</pre>
</div></div>

<p>You can also use Aegis with JAX-WS. Here's a Spring configuration example for that.</p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;bean id="aegisBean" class="org.apache.cxf.aegis.databinding.AegisDatabinding" scope="prototype"/&gt; 
&lt;bean id="jaxws-and-aegis-service-factory"
  class="org.apache.cxf.jaxws.support.JaxWsServiceFactoryBean"
  scope="prototype"&gt; 
  &lt;property name="dataBinding" ref="aegisBean"/&gt;
  &lt;!-- Use this property only for XFire compatibility -- this version for 2.0.x ...
  &lt;property name="serviceConfigurations"&gt;
    &lt;list&gt;
      &lt;bean class="org.apache.cxf.jaxws.support.JaxWsServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.aegis.databinding.AegisServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.service.factory.DefaultServiceConfiguration"/&gt; 
    &lt;/list&gt;
  &lt;/property&gt;
  --&gt;
  &lt;!-- Use this property only for XFire compatibility -- this version for 2.1
  &lt;property name="serviceConfigurations"&gt;
    &lt;list&gt;
      &lt;bean class="org.apache.cxf.jaxws.support.JaxWsServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.aegis.databinding.XFireCompatibilityServiceConfiguration"/&gt;
      &lt;bean class="org.apache.cxf.service.factory.DefaultServiceConfiguration"/&gt; 
    &lt;/list&gt;
  &lt;/property&gt;
  --&gt;
&lt;/bean&gt;

&lt;jaxws:endpoint id="my_service_endpoint" implementor="#my-service" address="/MyIndex"&gt;
  &lt;jaxws:serviceFactory&gt;
    &lt;ref bean='jaxws-and-aegis-service-factory' /&gt;
  &lt;/jaxws:serviceFactory&gt;
&lt;/jaxws:endpoint&gt;
</pre>
</div></div>

<h2 id="AegisDatabinding(2.0.x)-Javaconfiguration">Java configuration</h2>

<p>Here's a Java configuration using the Simple front end. </p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
import org.apache.cxf.aegis.databinding.AegisDatabinding;
import org.apache.cxf.frontend.ServerFactoryBean;

ServerFactoryBean sf = new ServerFactoryBean();
sf.setServiceClass(serviceClass);
sf.setAddress("http://myhost/service");
sf.getServiceFactory().setDataBinding(new AegisDatabinding());
sf.create();
</pre>
</div></div>

<p>Similarly, here is a client side using the simple front end. Note the use of the WSDL. Without the WSDL, the simple front end will try to learn<br clear="none">
parameters names from Java reflection. As always, Java interfaces don't carry parameter names, and this results in names like 'arg0', 'arg1', etc, which don't match the service.</p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
import org.apache.cxf.aegis.databinding.AegisDatabinding;
import org.apache.cxf.frontend.ClientProxyFactoryBean;

ClientProxyFactoryBean factory = new ClientProxyFactoryBean();
factory.setServiceClass(serviceInterfaceClassObject);
factory.setAddress("http://myhost/service");
factory.setWsdlLocation("http://myhost/service?wsdl");
factory.getServiceFactory().setDataBinding(new AegisDatabinding());
MyService client = (MyService) factory.create();
</pre>
</div></div>

<h2 id="AegisDatabinding(2.0.x)-XFireCompatibility">XFire Compatibility</h2>

<p>XFire had/has a different convention for generating namespace URI values from Java package names. It added an additional '/' character.<br clear="none">
If you need to interoperate with XFire, you need to enable compatibility with this behavior. You enable this compatibility by adding <br clear="none">
an additional service configuration class to your service configuration: XFireCompatibilityServiceConfiguration (in 2.0.x, AegisServiceConfiguration). <br clear="none">
The spring example above shows the necessary configuration in a comment. For the client side in Java, you need to add the service configuration to the service factory as follows:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
import org.apache.cxf.aegis.databinding.AegisServiceConfiguration;
// for 2.0.x
sf.getServiceFactory().getServiceConfigurations().add(0, new AegisServiceConfiguration());
// for 2.1
sf.getServiceFactory().getServiceConfigurations().add(0, new XFireCompatibilityServiceConfiguration());

</pre>
</div></div>
<p>This will the change the namespaces that CXF generates by default so that they are the same as XFire would generate.</p>


<h1 id="AegisDatabinding(2.0.x)-Class&lt;-&gt;XMLMappingOverview">Class &lt;-&gt; XML Mapping Overview</h1>

<p>Aegis has a flexible mapping system so you can control how your beans are controlled.  By default your POJOs are serialized based on their name and namespaces. If you have a class in the "org.codehaus.xfire" package named "Employee" it would be serialized in namespace "http://xfire.codehaus.org" with the local name "Employee"</p>

<p>Fore example, the java class:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
public class Employee
{
  private String name;
  private String title;

  public String getName() { return name; }
  public void setName(String name) { this.name = name; }

  public String getTitle() { return title; }
  public void setTitle(String title) { this.title = title; }
}
</pre>
</div></div>
<p>In XML this translates to:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;Employee xmlns="http://xfire.codehaus.org"&gt;
  &lt;name&gt;Santa Claus&lt;/name&gt;
  &lt;title&gt;Chief Present Officer (CPO)&lt;/title&gt;
&lt;/Employee&gt;
</pre>
</div></div>
<p>In XML Schema this would become a complex type:</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;xsd:complexType name="Employee"&gt;
  &lt;xsd:sequence&gt;
    &lt;xsd:element name="name" type="xsd:string" minOccurs="0" maxOccurs="1/&gt;
    &lt;xsd:element name="title" type="xsd:string" minOccurs="0" maxOccurs="1/&gt;
  &lt;/xsd:sequence&gt;
&lt;/xsd:complexType&gt;
</pre>
</div></div>

<div class="confluence-information-macro confluence-information-macro-information"><p class="title">Validate your mapping!</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>You can find an XML Schema for Aegis mapping files <a shape="rect" href="aegis-databinding-20x.data/aegis.xsd?version=1&amp;modificationDate=1190737394000&amp;api=v2" data-linked-resource-id="59670732" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="aegis.xsd" data-linked-resource-content-type="application/xml" data-linked-resource-container-id="49562" data-linked-resource-container-version="29">here</a>.<br clear="none">
 <a shape="rect" href="annotated-aegis-file-schema.html">This</a> version of the XML schema has comments to explain the bits and pieces.</p></div></div>

<h2 id="AegisDatabinding(2.0.x)-SupportedTypes">Supported Types</h2>

<ul><li>Basic types: int, double, float, long, byte[], short, String, BigDecimal</li><li>Arrays</li><li>Collections - including Maps</li><li>Dates: java.util.Date, java.util.Calendar, java.sql.Timestamp, java.sql.Date, java.sql.Time</li><li>XML: org.w3c.dom.Docmument, org.jdom.Element, XMLStreamReader, Source</li><li>Complex types which are aggregations of the above</li></ul>


<p>If you have constructors defined in your Java beans, make sure a default constructor (i.e. no arguments) is also declared. (Aegis needs a no-argument contstructor to instantiate client Java classes.)</p>

<h1 id="AegisDatabinding(2.0.x)-SettingDefaultminOccursandnillableParametersfromJava">Setting Default minOccurs and nillable Parameters from Java</h1>

<p>If you have many properties, and you want most, or all of them, to have a minOccurs other than 0 or a nillable other than <strong>false</strong>, you can change the defaults for Aegis from Java code (amongst other places).<br clear="none">
Here is an example: it extracts the binding provider from the service factory, and changes the configuration parameters.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
ServerFactoryBean sf = new ServerFactoryBean();
sf.setServiceClass(serviceClass);
sf.setAddress("http://myhost/service");
AegisDatabinding db = new AegisDatabinding();
sf.getServiceFactory().setDataBinding(db);

DefaultTypeMappingRegistry tmr = (DefaultTypeMappingRegistry)db.getTypeMappingRegistry();
// here we disuade XFire from its rather annoying tendency to assume that, just because
// anything in Java can be null, that we want to advertise all that nullity all over.
Configuration configuration = tmr.getConfiguration();
configuration.setDefaultMinOccurs(1);
configuration.setDefaultNillable(false);

sf.create();
</pre>
</div></div>

<h1 id="AegisDatabinding(2.0.x)-MoreInformation....">More Information....</h1>

<p>This section is under construction. For more information about how the Aegis databinding works, please check out the Aegis documentation at the XFire site (http://xfire.codehaus.org/User's%2bGuide).</p></div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </table>
   </td>
   <td id="cell-2-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
   <td id="cell-3-0">&nbsp;</td>
   <td id="cell-3-1">&nbsp;</td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">Privacy Policy</a> - 
         (<a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=49562">edit page</a>) 
	 (<a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=49562&amp;showComments=true&amp;showCommentArea=true#addcomment">add comment</a>)<br>
	Apache CXF, CXF, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.<br>
        All other marks mentioned may be trademarks or registered trademarks of their respective owners.
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3">&nbsp;</td>
   <td id="cell-3-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2">&nbsp;</td>
    <td id="cell-4-1">&nbsp;</td>
    <td id="cell-4-2" colspan="2">&nbsp;</td>
  </tr>
</table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>

</body>
</html>

