
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>

<link type="text/css" rel="stylesheet" href="/resources/site.css">
<script src='/resources/space.js'></script>

<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<meta name="keywords" content="business integration, EAI, SOA, Service Oriented Architecture, web services, SOAP, JBI, JMS, WSDL, XML, EDI, Electronic Data Interchange, standards support, integration standards, application integration, middleware, software, solutions, services, CXF, open source">
<meta name="description" content="Apache CXF, Services Framework - Using CXF-JCA RAR in Application Server">


<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shCoreCXF.css">
<link type="text/css" rel="stylesheet" href="/resources/highlighter/styles/shThemeCXF.css">

<script src='/resources/highlighter/scripts/shCore.js'></script>
<script src='/resources/highlighter/scripts/shBrushXml.js'></script>
<script src='/resources/highlighter/scripts/shBrushJava.js'></script>
<script>
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all();
</script>


    <title>
Apache CXF -- Using CXF-JCA RAR in Application Server
    </title>
  </head>
<body onload="init()">


<table width="100%" cellpadding="0" cellspacing="0">
  <tr>
    <td id="cell-0-0" colspan="2">&nbsp;</td>
    <td id="cell-0-1">&nbsp;</td>
    <td id="cell-0-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-1-0">&nbsp;</td>
    <td id="cell-1-1">&nbsp;</td>
    <td id="cell-1-2">
      <!-- Banner -->
<div class="banner" id="banner"><div><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td align="left" colspan="1" nowrap>
<a shape="rect" href="http://cxf.apache.org/" title="Apache CXF"><span style="font-weight: bold; font-size: 170%; color: white">Apache CXF</span></a>
</td><td align="right" colspan="1" nowrap>
<a shape="rect" href="http://www.apache.org/" title="The Apache Sofware Foundation"><img border="0" alt="ASF Logo" src="http://cxf.apache.org/images/asf-logo.png"></a>
</td></tr></table></div></div>
      <!-- Banner -->
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs -->
<a href="index.html">Index</a>&nbsp;&gt;&nbsp;<a href="deployment.html">Deployment</a>&nbsp;&gt;&nbsp;<a href="using-cxf-jca-rar-in-application-server.html">Using CXF-JCA RAR in Application Server</a>
                <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
<div id="quicklinks"><p><a shape="rect" href="http://cxf.apache.org/download.html">Download</a> | <a shape="rect" href="http://cxf.apache.org/docs/index.html">Documentation</a></p></div>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </table>
      </div>
    </td>
    <td id="cell-1-3">&nbsp;</td>
    <td id="cell-1-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-2-0" colspan="2">&nbsp;</td>
    <td id="cell-2-1">
      <table>
        <tr valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
<div id="navigation"><ul class="alternate"><li><a shape="rect" href="overview.html">Overview</a></li><li><a shape="rect" href="how-tos.html">How-Tos</a></li><li><a shape="rect" href="frontends.html">Frontends</a></li><li><a shape="rect" href="databindings.html">DataBindings</a></li><li><a shape="rect" href="transports.html">Transports</a></li><li><a shape="rect" href="configuration.html">Configuration</a></li><li><a shape="rect" href="debugging-and-logging.html">Debugging and Logging</a></li><li><a shape="rect" href="tools.html">Tools</a></li><li><a shape="rect" href="restful-services.html">RESTful Services</a></li><li><a shape="rect" href="wsdl-bindings.html">WSDL Bindings</a></li><li><a shape="rect" href="service-routing.html">Service Routing</a></li><li><a shape="rect" href="dynamic-languages.html">Dynamic Languages</a></li><li><a shape="rect" href="ws-support.html">WS-* Support</a></li><li><a shape="rect" href="advanced-integration.html">Advanced Integration</a></li><li><a shape="rect" href="deployment.html">Deployment</a></li><li><a shape="rect" href="schemas-and-namespaces.html">Use of Schemas and Namespaces</a></li></ul><hr><ul class="alternate"><li><p>Search</p></li></ul><form enctype="application/x-www-form-urlencoded" method="get" id="cse-search-box" action="http://www.google.com/cse">
  <div>
    <input type="hidden" name="cx" value="002890367768291051730:o99qiwa09y4">
    <input type="hidden" name="ie" value="UTF-8">
    <input type="text" name="q" size="21">
    <input type="submit" name="sa" value="Search">
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script><hr><ul class="alternate"><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest/">API 3.2.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/javadoc/latest-3.1.x/">API 3.1.x (Javadoc)</a></li><li><a shape="rect" href="http://cxf.apache.org/">CXF Website</a></li></ul><p>&#160;</p><p><a shape="rect" class="external-link" href="http://www.apache.org/events/current-event.html"><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image confluence-external-resource" src="http://www.apache.org/events/current-event-125x125.png" data-image-src="http://www.apache.org/events/current-event-125x125.png"></span></a></p></div>
                    <!-- NavigationBar -->
                  </div>
              </div>
            </div>
          </div>
         </td>
         <td height="100%">
           <!-- Content -->
           <div class="wiki-content">
<div id="ConfluenceContent"><h1 id="UsingCXFJCARARinApplicationServer-DeployCXF-JCARAR.">Deploy CXF-JCA RAR.</h1>
<p>cxf-integration-jca module has implemented the JCA1.5 outbound connection. You can see samples in $CXF_HOME/samples/integration/jca.</p>

<style type="text/css">/*<![CDATA[*/
div.rbtoc1636141534710 {padding: 0px;}
div.rbtoc1636141534710 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1636141534710 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1636141534710">
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeployCXF-JCARAR.">Deploy CXF-JCA RAR.</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-BuildCXF-JCARAR">Build CXF-JCA RAR</a></li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeployRARtoJBOSS.">Deploy RAR to JBOSS.</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeploythestandaloneRAR.">Deploy the standalone RAR.</a></li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeploytheRARinEAR.">Deploy the RAR in EAR.</a></li></ul>
</li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeployRARtoWeblogic.">Deploy RAR to Weblogic.</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-PackageRARinanEAR.">Package RAR in an EAR.</a></li></ul>
</li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-DeployRARtoWebSphere.">Deploy RAR to WebSphere.</a></li></ul>
</li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-UsingJCAConnection.">Using JCA Connection.</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-GetConnectionfromManagedConnectionFactory.">Get Connection from ManagedConnectionFactory.</a></li><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-UsingCXF-JCARARtoaccesstheStatelessSessionBean.">Using CXF-JCA RAR to access the Stateless Session Bean.</a>
<ul class="toc-indentation"><li><a shape="rect" href="#UsingCXFJCARARinApplicationServer-Activatetheejb_servant.propertiesfile.">Activate the ejb_servant.properties file.</a></li></ul>
</li></ul>
</li></ul>
</div>

<h2 id="UsingCXFJCARARinApplicationServer-BuildCXF-JCARAR">Build CXF-JCA RAR</h2>
<p>    The jca rar package structure would be:</p>
    <div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>    |---META-INF
    |---META-INF/ra.xml
    |---cxf-api-2.1.jar
    |---cxf-integration-jca-2.1.jar
    |---.....
    </pre>
</div></div>

<p>Refer to this <a shape="rect" class="external-link" href="https://svn.apache.org/repos/asf/incubator/cxf/trunk/distribution/src/main/release/samples/integration/jca/inbound/build.xml">build.xml</a> "generate.rar" target for building rar detail.</p>

<h2 id="UsingCXFJCARARinApplicationServer-DeployRARtoJBOSS.">Deploy RAR to JBOSS.</h2>

<h3 id="UsingCXFJCARARinApplicationServer-DeploythestandaloneRAR.">Deploy the standalone RAR.</h3>
<p><strong>(Note: This has been tested against JBoss4.0.5)</strong></p>

<ol><li>You need to put below jars in the $JBOSS_HOME/lib/endorsed.
	<ul><li>geronimo-activation_1.1_spec-1.0-M1.jar</li><li>geronimo-annotation_1.0_spec-1.1.jar</li><li>geronimo-ws-metadata_2.0_spec-1.1.1.jar</li><li>jaxb-api-2.1.jar</li><li>jaxb-impl-2.1.4.jar</li><li>jaxb-xjc-2.1.4.jar</li><li>jsr181-api-1.0-MR1.jar</li><li>saaj-api-1.3.jar</li><li>saaj-impl-1.3.jar</li><li>stax-api-1.0.1.jar</li><li>stax-utils-20060502.jar</li></ul>
	</li><li>Copy the rar to the $JBOSS_HOME/server/default</li><li>Create the cxfj2ee_1_5-ds.xml as below, and copy it to $JBOSS_HOME/server/default
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;!DOCTYPE connection-factories
    PUBLIC "-//JBoss//DTD JBOSS JCA Config 1.5//EN"
    "http://www.jboss.org/j2ee/dtd/jboss-ds_1_5.dtd"&gt;
&lt;connection-factories&gt;
  &lt;no-tx-connection-factory&gt;
    &lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
    &lt;rar-name&gt;cxf.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-definition&gt;
  &lt;/no-tx-connection-factory&gt;
&lt;/connection-factories&gt;
</pre>
</div></div></li></ol>


<p>You can refer to jca sample's <a shape="rect" class="external-link" href="https://svn.apache.org/repos/asf/incubator/cxf/trunk/distribution/src/main/release/samples/integration/jca/inbound/README.txt">README</a> for detail.</p>

<h3 id="UsingCXFJCARARinApplicationServer-DeploytheRARinEAR.">Deploy the RAR in EAR.</h3>
<p><strong>(Note: This has been tested against JBoss4.0.5 and JBoss4.2.1)</strong></p>
<ul><li>Having application.xml
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;application&gt;
	&lt;display-name&gt;cxf-jca&lt;/display-name&gt;
	&lt;module&gt;
		&lt;connector&gt;cxf.rar&lt;/connector&gt;
	&lt;/module&gt;
&lt;/application&gt;
</pre>
</div></div></li></ul>


<ul><li>Having jboss-app.xml to configure the classloader.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jboss-app&gt;
	&lt;loader-repository&gt;
		apache.cxf:loader=cxf.ear
		&lt;loader-repository-config&gt;
			java2ParentDelegation=true
		&lt;/loader-repository-config&gt;
	&lt;/loader-repository&gt;
	&lt;module&gt;
		&lt;service&gt;cxf-ds.xml&lt;/service&gt;
	&lt;/module&gt;
&lt;/jboss-app&gt;
</pre>
</div></div></li></ul>


<ul><li>Having cxf-ds for jca outbound in JBoss.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
 &lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;connection-factories&gt;
  &lt;no-tx-connection-factory&gt;
    &lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
    &lt;rar-name&gt;cxf.ear#cxf.rar&lt;/rar-name&gt;
    &lt;connection-definition&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-definition&gt;
  &lt;/no-tx-connection-factory&gt;
&lt;/connection-factories&gt;
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>  The rar name should be full name, which is ear-name#rar-name, instead of rar-name alone.</p></div></div></li><li>put the application.xml and jboss-app.xml in the META-INF folder.</li><li>put the cxf.rar and the cxf-ds.xml in an EAR.</li></ul>


<ul><li>
	<ul><li>For the JBoss4.0.5, Need to put the <strong>geronimo-ws-metadata_2.0_spec-1.1.1.jar</strong> in the <strong>$JBOSS_HOME/lib/endorsed</strong> folder.<br clear="none">
   Make sure the cxf.rar library does not contain <strong>xml-apis.jar and xml-resolver.jar</strong>.</li><li>For the JBoss4.2.1, Doesn't need to put any jars in the endorsed folder, but need to make sure cxf.rar library<br clear="none">
   does not contain <strong>xml-api.jar</strong>.</li></ul>
	</li></ul>





<h2 id="UsingCXFJCARARinApplicationServer-DeployRARtoWeblogic.">Deploy RAR to Weblogic.</h2>
<p><strong>(Note: this has been tested against WebLogic9.1)</strong></p>

<h3 id="UsingCXFJCARARinApplicationServer-PackageRARinanEAR.">Package RAR in an EAR.</h3>
<ul><li>Add a weblogic-ra.xml in the <strong>META-INF</strong> folder.
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
&lt;weblogic-connector xmlns="http://www.bea.com/ns/weblogic/90"&gt;
    &lt;outbound-resource-adapter&gt;
        &lt;connection-definition-group&gt;
	   &lt;connection-factory-interface&gt;org.apache.cxf.connector.CXFConnectionFactory&lt;/connection-factory-interface&gt;
           &lt;connection-instance&gt;    
		&lt;jndi-name&gt;CXFConnector&lt;/jndi-name&gt;
           &lt;/connection-instance&gt;
        &lt;/connection-definition-group&gt;
    &lt;/outbound-resource-adapter&gt;
&lt;/weblogic-connector&gt;
</pre>
</div></div></li></ul>


<ul><li>Package the RAR in an EAR with application.xml.</li><li>Put the <strong>geronimo-ws-metadata_2.0_spec-1.1.1.jar</strong> in the $WebLogic_HOME/$JDK_Home/jre/lib/endorsed</li></ul>



<h2 id="UsingCXFJCARARinApplicationServer-DeployRARtoWebSphere.">Deploy RAR to WebSphere.</h2>

<p>TBD</p>

<h1 id="UsingCXFJCARARinApplicationServer-UsingJCAConnection.">Using JCA Connection.</h1>

<h2 id="UsingCXFJCARARinApplicationServer-GetConnectionfromManagedConnectionFactory.">Get Connection from ManagedConnectionFactory.</h2>
<p>Below is the code snippet to get the Connection.</p>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">

        URL wsdl = getClass().getResource("/wsdl/hello_world.wsdl");                
        CXFConnectionRequestInfo cri = new CXFConnectionRequestInfo(Greeter.class, 
                                           wsdl,
                                           serviceName,
                                           portName);
        ManagedConnectionFactory managedFactory = new ManagedConnectionFactoryImpl();
        Subject subject = new Subject();
        ManagedConnection mc = managedFactory.createManagedConnection(subject, cri);        
        Object o = mc.getConnection(subject, cri);
</pre>
</div></div>

<p>Also can get the connection without wsdl, but you need to provide the address.</p>

<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">

        CXFConnectionRequestInfo requestInfo = new CXFConnectionRequestInfo();
        requestInfo.setInterface(Greeter.class);
        requestInfo.setAddress("http://localhost:9000/SoapContext/SoapPort");
        
        ManagedConnectionFactory factory = new ManagedConnectionFactoryImpl();
        ManagedConnection mc = factory.createManagedConnection(null, requestInfo);
        Object client = mc.getConnection(null, requestInfo);
</pre>
</div></div>

<h2 id="UsingCXFJCARARinApplicationServer-UsingCXF-JCARARtoaccesstheStatelessSessionBean.">Using CXF-JCA RAR to access the Stateless Session Bean.</h2>
<p>By using cxf-jca RAR, the EIS is able to access the Stateless Session Bean by CXF Interal API or JAXWS API.<br clear="none">
If you want to deploy the Stateless Session Bean, you need to modify the ejb_servant.properties file.</p>
<h3 id="UsingCXFJCARARinApplicationServer-Activatetheejb_servant.propertiesfile.">Activate the ejb_servant.properties file.</h3>
<div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="brush: java; gutter: false; theme: Default">
# Format: 
# jndi_name={namespace}ServiceName@url_to_swdl
#   
# jndi_name: The JNDI name that an external client uses to contact the bean.
# ServiceName: The string form of the QName for the service in the WSDL file.
# @url_to_wsdl: The string form of a URL that identifies the WSDL file.
#
# Example:
# GreeterBean={http://apache.org/hello_world_soap_http}Greeter@file:c:/wsdl/hello_world.wsdl
</pre>
</div></div>
<div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p> You can specify the ejb_servant.properties file location in the $RAR/META-INF/ra.xml "EJBServicePropertiesURL" property value. </p></div></div>
<div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p> You need to deploy the ejbs before activate the ejb_servant.properties file, otherwise, it won't find the JNDI name.</p></div></div>

</div>
           </div>
           <!-- Content -->
         </td>
        </tr>
      </table>
   </td>
   <td id="cell-2-2" colspan="2">&nbsp;</td>
  </tr>
  <tr>
   <td id="cell-3-0">&nbsp;</td>
   <td id="cell-3-1">&nbsp;</td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://cxf.apache.org/privacy-policy.html">Privacy Policy</a> - 
         (<a href="https://cwiki.apache.org/confluence/pages/editpage.action?pageId=67429">edit page</a>) 
	 (<a href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=67429&amp;showComments=true&amp;showCommentArea=true#addcomment">add comment</a>)<br>
	Apache CXF, CXF, Apache, the Apache feather logo are trademarks of The Apache Software Foundation.<br>
        All other marks mentioned may be trademarks or registered trademarks of their respective owners.
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3">&nbsp;</td>
   <td id="cell-3-4">&nbsp;</td>
  </tr>
  <tr>
    <td id="cell-4-0" colspan="2">&nbsp;</td>
    <td id="cell-4-1">&nbsp;</td>
    <td id="cell-4-2" colspan="2">&nbsp;</td>
  </tr>
</table>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4458903-1");
pageTracker._trackPageview();
} catch(err) {}</script>

</body>
</html>

