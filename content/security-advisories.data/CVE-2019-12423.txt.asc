-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

CVE-2019-12423: Apache CXF OpenId Connect JWK Keys service returns private/secret credentials if configured with a jwk keystore

Severity: Moderate

Vendor: The Apache Software Foundation

Versions Affected: 

This vulnerability affects all versions of Apache CXF prior to 3.3.5 and
3.2.12.

Description:

Apache CXF ships with a OpenId Connect JWK Keys service, which allows a client
to obtain the public keys in JWK format, which can then be used to verify the
signature of tokens issued by the service.

Typically, the service obtains the public key from a local keystore
(JKS/PKCS12) by specifing the path of the keystore and the alias of the
keystore entry. This case is not vulnerable.

However it is also possible to obtain the keys from a JWK keystore file, by
setting the configuration parameter "rs.security.keystore.type" to "jwk". For
this case all keys are returned in this file "as is", including all private
key and secret key credentials.

This is an obvious security risk if the user has configured the signature
keystore file with private or secret key credentials.

- From CXF 3.3.5 and 3.2.12, it is mandatory to specify an alias corresponding
to the id of the key in the JWK file, and only this key is returned. In
addition, any private key information is omitted by default. "oct" keys, which
contain secret keys, are not returned at all.

Mitigation:

Users of Apache CXF that user the OpenId Connect JWK keys service as part of
their OpenId Connect service should update to either the 3.3.5 or 3.2.12
releases.
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEE20Xs0ZuXUU9ycQWuZ7+AsQrVOYMFAl4gWWMACgkQZ7+AsQrV
OYO+Gwf/b2cRwqNHqpRn0YWipvBWSHv0zxOx1x0XPGUcMYiFvnEEfFBH2o+4lTeS
Jn8TokwM767oBv7DmmivYk3CzxNSJJmPQLJxO4B7QA//SS3zpNp9lD5Upl8V1Uok
FKqX4TeT0Y+YURZg6vvZSvJ2c+wmkx+Nut1FA1YUk4UCgLc9vfuOFYvicL/DOsqB
mqk7PXI24JjzSTjkYCEe35mABwtya/gg0bqFwhHF3vsWw+zObw2QUAv3tF06efOX
lrniZAu4Ky0Mp1dhiJxD4+XrFV5KMdUuwkXrrN4iccjjzlh/x4crOwlggurEXdRJ
mWYCrWut4O6ZBodgNMPZT0KKnDzOVg==
=KKJd
-----END PGP SIGNATURE-----
